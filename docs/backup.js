import{db,saveDb}from"./db.js";export function renderBackupRestore(e){e.innerHTML='\n    <div class="container my-4">\n      <div class="d-flex align-items-center justify-content-between">\n        <h4><i class="bi bi-hdd"></i> Backup & Restore</h4>\n      </div>\n      <div class="card shadow-sm mb-4">\n        <div class="card-body">\n          <h6>Backup Data</h6>\n          <p class="small text-muted">Download a backup of all Thynktech system data to your device. Store it securely.</p>\n          <button class="btn btn-primary" id="backupBtn"><i class="bi bi-download"></i> Download Backup</button>\n        </div>\n      </div>\n      <div class="card shadow-sm">\n        <div class="card-body">\n          <h6>Restore Data</h6>\n          <p class="small text-muted">Restore data from a Thynktech backup file. <b>This will overwrite all current data.</b></p>\n          <input type="file" id="restoreFile" accept=".json" class="form-control mb-2">\n          <button class="btn btn-danger" id="restoreBtn"><i class="bi bi-upload"></i> Restore Backup</button>\n        </div>\n      </div>\n      <a href="#admin-dashboard" class="btn btn-link mt-3"><i class="bi bi-arrow-left"></i> Back</a>\n      <div id="backupMsg" class="mt-3"></div>\n    </div>\n  ',e.querySelector("#backupBtn").onclick=()=>{const t=btoa(JSON.stringify(db)),a=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(a),n=document.createElement("a");n.href=r,n.download=`thynktech-backup-${(new Date).toISOString().slice(0,10)}.json`,document.body.appendChild(n),n.click(),setTimeout(()=>{document.body.removeChild(n),URL.revokeObjectURL(r)},100),e.querySelector("#backupMsg").innerHTML='<div class="alert alert-success">Encrypted backup downloaded.</div>'},e.querySelector("#restoreBtn").onclick=()=>{const t=e.querySelector("#restoreFile").files[0];if(!t)return void(e.querySelector("#backupMsg").innerHTML='<div class="alert alert-warning">Please select an encrypted backup file to restore.</div>');if(!confirm("Are you sure you want to restore from backup? This will overwrite all current data."))return;const a=new FileReader;a.onload=function(t){try{const a=atob(t.target.result),r=JSON.parse(a);Object.keys(db).forEach(e=>delete db[e]),Object.assign(db,r),saveDb(),e.querySelector("#backupMsg").innerHTML='<div class="alert alert-success">Restore complete. Please reload the page.</div>'}catch(t){e.querySelector("#backupMsg").innerHTML='<div class="alert alert-danger">Restore failed: Invalid or corrupted encrypted file.</div>'}},a.readAsText(t)}}